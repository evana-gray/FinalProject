[
  {
    "objectID": "Modeling.html",
    "href": "Modeling.html",
    "title": "Modeling",
    "section": "",
    "text": "This section of the project will focus on fitting statistical models to our dataset in hopes of being able to take in new information about an individual and predict if they have diabetes. A classification tree model and a random forest model, both of differing tuning parameters, will be compared to each other to determine which is more accurate. The initial steps will be the same as the EDA section - the data must be read in and factors will be created for our categorical variables.\nlibrary(tidyverse)\n\nWarning: package 'tidyverse' was built under R version 4.4.3\n\n\nWarning: package 'ggplot2' was built under R version 4.4.3\n\n\nWarning: package 'tidyr' was built under R version 4.4.3\n\n\nWarning: package 'readr' was built under R version 4.4.3\n\n\nWarning: package 'dplyr' was built under R version 4.4.3\n\n\nWarning: package 'stringr' was built under R version 4.4.3\n\n\nWarning: package 'forcats' was built under R version 4.4.3\n\n\nWarning: package 'lubridate' was built under R version 4.4.3\n\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   4.0.0     ✔ tibble    3.2.1\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(tidymodels)\n\nWarning: package 'tidymodels' was built under R version 4.4.3\n\n\n── Attaching packages ────────────────────────────────────── tidymodels 1.4.1 ──\n✔ broom        1.0.9     ✔ rsample      1.3.1\n✔ dials        1.4.2     ✔ tailor       0.1.0\n✔ infer        1.0.9     ✔ tune         2.0.1\n✔ modeldata    1.5.1     ✔ workflows    1.3.0\n✔ parsnip      1.3.3     ✔ workflowsets 1.1.1\n✔ recipes      1.3.1     ✔ yardstick    1.3.2\n\n\nWarning: package 'broom' was built under R version 4.4.3\n\n\nWarning: package 'dials' was built under R version 4.4.3\n\n\nWarning: package 'scales' was built under R version 4.4.3\n\n\nWarning: package 'infer' was built under R version 4.4.3\n\n\nWarning: package 'modeldata' was built under R version 4.4.3\n\n\nWarning: package 'parsnip' was built under R version 4.4.3\n\n\nWarning: package 'recipes' was built under R version 4.4.3\n\n\nWarning: package 'rsample' was built under R version 4.4.3\n\n\nWarning: package 'tailor' was built under R version 4.4.3\n\n\nWarning: package 'tune' was built under R version 4.4.3\n\n\nWarning: package 'workflows' was built under R version 4.4.3\n\n\nWarning: package 'workflowsets' was built under R version 4.4.3\n\n\nWarning: package 'yardstick' was built under R version 4.4.3\n\n\n── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──\n✖ scales::discard() masks purrr::discard()\n✖ dplyr::filter()   masks stats::filter()\n✖ recipes::fixed()  masks stringr::fixed()\n✖ dplyr::lag()      masks stats::lag()\n✖ yardstick::spec() masks readr::spec()\n✖ recipes::step()   masks stats::step()\n\nlibrary(rsample)\nlibrary(parsnip)\nlibrary(tree)\n\nWarning: package 'tree' was built under R version 4.4.3\n\nlibrary(rpart)\n\nWarning: package 'rpart' was built under R version 4.4.3\n\n\n\nAttaching package: 'rpart'\n\nThe following object is masked from 'package:dials':\n\n    prune\n\nlibrary(rpart.plot)\n\nWarning: package 'rpart.plot' was built under R version 4.4.3\n\nlibrary(baguette)\n\nWarning: package 'baguette' was built under R version 4.4.3\n\nlibrary(ranger)\n\nWarning: package 'ranger' was built under R version 4.4.3\n\nlibrary(yardstick)\nlibrary(future)\n\nWarning: package 'future' was built under R version 4.4.3\n\n#set seed for repeatable results where randomization occurs. \nset.seed(16)\n\n#this command allows for parallel computing and faster run times\nplan(multisession, workers = 14)\n#Read Data\ndiabetes &lt;- read_csv(\"../diabetes_binary_health_indicators_BRFSS2015.csv\")\n\nRows: 253680 Columns: 22\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\ndbl (22): Diabetes_binary, HighBP, HighChol, CholCheck, BMI, Smoker, Stroke,...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n#convert col names to lower case for easy reference\ncolnames(diabetes) &lt;- tolower(colnames(diabetes))\n#Create Factors\ndiabetes &lt;- diabetes |&gt;\n  mutate(\n    diabetes_binary_f = factor(diabetes_binary, levels = c(0,1),\n                               labels = c(\"no diabetes\", \"diabetes\")), \n    highbp_f = factor(highbp, levels = c(0,1),\n                               labels = c(\"no high BP\", \"high BP\")),\n    highchol_f = factor(highchol, levels = c(0,1),\n                               labels = c(\"no high cholesterol\", \"high cholesterol\")),\n    cholcheck_f = factor(cholcheck, levels = c(0,1),\n                               labels = c(\"no cholesterol check in 5 years\", \"yes cholesterol check in 5 years\")),\n    smoker_f = factor(smoker, levels = c(0,1),\n                               labels = c(\"no\", \"yes\")), \n    stroke_f = factor(stroke, levels = c(0,1),\n                               labels = c(\"no\", \"yes\")),\n    heartdiseaseorattack_f = factor(heartdiseaseorattack, levels = c(0,1),\n                               labels = c(\"no\", \"yes\")),\n    physactivity_f = factor(physactivity, levels = c(0,1),\n                               labels = c(\"no\", \"yes\")),\n    fruits_f = factor(fruits, levels = c(0,1),\n                               labels = c(\"no\",\"yes\")),\n    veggies_f = factor(veggies, levels = c(0,1),\n                               labels = c(\"no\", \"yes\")),\n    hvyalcoholconsump_f = factor(hvyalcoholconsump, levels = c(0,1),\n                               labels = c(\"no\", \"yes\")),\n    anyhealthcare_f = factor(anyhealthcare, levels = c(0,1),\n                               labels = c(\"no\", \"yes\")),\n    nodocbccost_f = factor(nodocbccost, levels = c(0,1),\n                               labels = c(\"no\",\"yes\")),\n    genhlth_f = factor(genhlth, levels = 1:5,\n                               labels = c(\"excellent\", \"very good\", \"good\", \"fair\", \"poor\")),\n    diffwalk_f  = factor(diffwalk, levels = c(0,1),\n                               labels = c(\"no\", \"yes\")),\n    sex_f = factor(sex, levels = c(0,1),\n                               labels = c(\"female\", \"male\")),\n    age_f = factor(age, levels = 1:13,\n                        labels = c(\"18 to 24\",\n                          \"25 to 29\", \n                          \"30 to 34\", \n                          \"35 to 39\",\n                          \"40 to 44\",\n                          \"45 to 49\",\n                          \"50 to 54\",\n                          \"55 to 59\",\n                          \"60 to 64\",\n                          \"65 to 69\",\n                          \"70 to 74\",\n                          \"75 to 79\", \n                          \"80 to high\"\n                   )),\n    education_f = factor(education, levels = 1:6,\n                         labels = c(\"Never attended school or only kindergarten\",\n                         \"Grades 1 through 8 (Elementary)\",\n                         \"Grades 9 through 11 (Some high school)\",\n                         \"Grade 12 or GED (High school graduate)\",\n                         \"College 1 year to 3 years (Some college or technical school)\",\n                         \"College 4 years or more (College graduate)\")\n                         ),\n    income_f = factor(income, levels = 1:8,\n                      labels = c(\"&lt; 10k\",\n                                \"&lt; 15k\",\n                                \"&lt; 20k\",\n                                \"&lt; 25k\",\n                                \"&lt; 35k\",\n                                \"&lt; 50k\",\n                                \"&lt; 75k\",\n                                \"75k+\"))\n  )\n#Subset Variables of Interest\nFirst, we will include only the variables needed for training and testing. The full dataset is removed due to save memory.\ndiabetes_model_data &lt;- diabetes |&gt;\n  select(diabetes_binary_f, highbp_f, sex_f, income_f, age_f, bmi)\nrm(diabetes) #remove large original file",
    "crumbs": [
      "Home",
      "Modeling"
    ]
  },
  {
    "objectID": "Modeling.html#confusion-matrix",
    "href": "Modeling.html#confusion-matrix",
    "title": "Modeling",
    "section": "Confusion Matrix",
    "text": "Confusion Matrix\n\nrf_lastfit &lt;- extract_workflow(rf3_final_fit)\n\npredict_ds &lt;- diabetes_model_data |&gt;\n    mutate(\n      estimate = rf_lastfit |&gt;\n        predict(diabetes_model_data) )\n\nmatrix &lt;- conf_mat(\n  diabetes_model_data |&gt;\n    mutate(\n      estimate = rf_lastfit |&gt;\n        predict(diabetes_model_data) |&gt;\n        pull()),\n  diabetes_binary_f,\n  estimate\n    )\nmatrix\n\n             Truth\nPrediction    no diabetes diabetes\n  no diabetes      217870    34377\n  diabetes            464      969\n\nautoplot(matrix)\n\n\n\n\n\n\n\n\n\n#reset plan to default\nplan(sequential)",
    "crumbs": [
      "Home",
      "Modeling"
    ]
  }
]